import boto3
import json
from io import StringIO, BytesIO

def get_tag_editors_by_resource_type(resource_type):
    # Configure your AWS region
    region = 'your_aws_region'

    # Initialize the Resource Groups client
    resource_groups_client = boto3.client('resource-groups', region_name=region)

    # Get resources with tags of the specified resource type
    resources_response = resource_groups_client.get_resources(
        ResourceTypeFilters=[resource_type],
        TagFilters=[]
    )

    # Extract tag keys from the resources
    resource_tag_editors = set()
    for resource in resources_response['ResourceIdentifiers']:
        if 'Tags' in resource:
            for tag in resource['Tags']:
                resource_tag_editors.add(tag['Key'])

    # Create a CSV string to store the data
    csv_buffer = StringIO()
    csv_buffer.write("Tag Key\n")

    # Write the resource tag editors to the CSV buffer
    for tag_editor in resource_tag_editors:
        csv_buffer.write(f"{tag_editor}\n")

    # Create an Excel file buffer to store the data
    excel_buffer = BytesIO()
    excel_buffer.write(csv_buffer.getvalue().encode())
    excel_buffer.seek(0)

    return excel_buffer

# Rest of the code remains the same as the previous version

# ...
# Your lambda_handler function and the email sending part

