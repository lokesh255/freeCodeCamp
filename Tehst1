import boto3

def lambda_handler(event, context):
    # Extract the relevant information from the CloudTrail event
    s3_name = event['detail']['requestParameters']['bucketName']
    event_source = event['detail']['eventSource']
    event_name = event['detail']['eventName']
    user_identity = event['detail'].get('userIdentity', {})
    user_name = user_identity.get('userName', 'Unknown')
    assume_role = user_identity.get('sessionContext', {}).get('sessionIssuer', {}).get('arn', 'Unknown')

    # Compose the email body
    email_body = f"S3 Bucket Creation Report:\n\n"
    email_body += f"S3 Bucket Name: {s3_name}\n"
    email_body += f"Event Source: {event_source}\n"
    email_body += f"Event Name: {event_name}\n"
    email_body += f"User Name: {user_name}\n"
    email_body += f"Assume Role: {assume_role}\n"

    # Send the email using Amazon SES
    ses_client = boto3.client('ses')
    ses_client.send_email(
        Source='your_email@example.com',
        Destination={
            'ToAddresses': ['recipient@example.com']
        },
        Message={
            'Subject': {
                'Data': 'S3 Bucket Creation Report'
            },
            'Body': {
                'Text': {
                    'Data': email_body
                }
            }
        }
    )
